<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#1976d2" />
    <meta name="description" content="!!JazzVIBE - Visual Interface for Biostatistical Exploration" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <!-- Material-UI Roboto Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap"
    />
    
    <!-- Material Icons -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    
    <title>JazzVIBE</title>
    
    <!-- Dynamic base path handling -->
    <script>
      // Only run client-side detection if server didn't provide path
      if (!window.__POSIT_BASE_PATH__) {
        (function() {
          var pathname = window.location.pathname;
          var basePath = '';
          
          // Posit Workbench pattern: /s/{session}/p/{port}/
          var workbenchMatch = pathname.match(/^(\/s\/[^\/]+\/p\/[^\/]+)\//);
          if (workbenchMatch) {
            basePath = workbenchMatch[1] + '/';
          }
          // Posit Connect pattern: /connect/#/apps/{app-id}/access
          else if (pathname.includes('/connect/')) {
            var connectMatch = pathname.match(/^(\/connect\/#\/apps\/[^\/]+\/access)/);
            if (connectMatch) {
              basePath = connectMatch[1] + '/';
            }
          }
          
          if (basePath) {
            console.log('Client detected base path:', basePath);
            window.__POSIT_BASE_PATH__ = basePath;
            
            // Set the base element if not already set
            if (!document.querySelector('base')) {
              var baseElement = document.createElement('base');
              baseElement.href = basePath;
              document.head.appendChild(baseElement);
            }
          }
        })();
      }
    </script>
    
    <style>
      /* Loading screen styles */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #f5f5f5;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }
      
      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #e0e0e0;
        border-top: 4px solid #1976d2;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 16px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .loading-text {
        font-family: 'Roboto', sans-serif;
        font-size: 18px;
        color: #666;
        margin: 0;
      }
      
      /* Hide loading screen when React app loads */
      #root:not(:empty) + .loading-screen {
        display: none;
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    
    <!-- Loading screen shown while React app loads -->
    <div class="loading-screen">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading Jazz Vibe...</p>
    </div>
    
    <!-- 
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.
      
      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.
      
      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  </body>
</html>
